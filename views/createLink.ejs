<%- include('../views/include/header.ejs')%>
<%- include('../views/include/nav.ejs')%>

<script type="text/javascript">
    $(document).ready(function(){

        $( "#form" ).submit(function(event) {
            event.preventDefault();

            $.ajax({
                type: 'POST',
                url: '/link/createLink',
                data: $('#form').serialize(),
                dataType: "json",
                success: function(response){
                    //alert("a");
                    //console.log(response.Success);
                    $('#form')[0].reset();

                    document.getElementById("check").innerHTML=response.Success;
                         //ADD THIS CODE
                         setTimeout(function(){
                             document.getElementById("check").innerHTML="";
                         },3000);
                         if (response.Success=="Success!") {
                             document.getElementById("aa").setAttribute("href", response.quiz_id);
                             document.getElementById("aa").click();
                         };
                     },
                     error: function() {
                     }
                 })
        });

    });
</script>
<style>
  .tooltip {
    position: relative;
    display: inline-block;
  }
  
  .tooltip .tooltiptext {
    visibility: hidden;
    width: 140px;
    background-color: #555;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 5px;
    position: absolute;
    z-index: 1;
    bottom: 150%;
    left: 50%;
    margin-left: -75px;
    opacity: 0;
    transition: opacity 0.3s;
  }
  
  .tooltip .tooltiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #555 transparent transparent transparent;
  }
  
  .tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
  }
  </style>
<div class="container-sm">
    <div class="card" style="width: 50%; padding: 5%; margin: 3rem auto 3rem auto;">
        <div style="text-align: center; margin: 2rem;">
			<h1>Link quiz</h1>
		</div>

        <form method="post"id="form">
            <div class="mb-3">
              <label for="quizname" class="form-label">Quiz name</label>
              <input type="text" class="form-control" name="name" id="quizname" aria-describedby="quiznameHelp" required>
              <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
              
            </div>
            <div style="display: flex; justify-content: center;">
                <input type="submit" style="width: 80%; " value="Create" class="btn btn-primary">
            </div>
          </form>

         
          <div class="mssg bg-danger">
			<span id="check" ></span>
		</div>
		<div id="LangTable"><a  id="aa"></a>
		</div>
    </div>

    <div class="card" >
			<div class="card-header">
				Qiuz's 
			</div>
			<% if (quizs.length  != 0) { %>
			  <ul class="list-group list-group-flush">
          <% quizs.forEach(function(obj) { %>
            <li class="list-group-item">

					<table style="width: 100%; text-align: center; ">
						<tr>
						  <td style="width: 50%;"><%= obj.name %></td> 
						  <td style="width: 25%;"><a  style=" text-decoration: none;color: black;" href="/link/addQuestion/<%= obj.quiz_id %>"><i class="fa fa-edit"></i></a></a></td>
						  <td style="width: 25%;"><a  style=" text-decoration: none;color: black;" href="/link/deleteQuizName/<%= obj._id %>"><i class="fa fa-trash"></i></a></a></td>
						  <td style="width: 25%;"><input type="text" hidden id="myInput"><button onclick="myFunction()" onmouseout="outFunc()"  style=" text-decoration: none;color: black;" href="/link/quiz/<%= obj.quiz_id %>"><span class="tooltiptext" id="myTooltip"></span><i class="fa fa-share"></i></button></a></td>
						</tr>
					  </table>
				 </li>
			   <% }); %> 
			  </ul>
			  <%} else { %> 
				<div style="margin: 1rem;" class="alert alert-danger" role="alert">
					Quiz are not created At! <a href="/link/create">click here</a>
				  </div>

				<% } %> 
			</div>
		
</div>
<script>
  function myFunction() {
    var copyText = document.getElementById("myInput");
    copyText.value = window.location.href
    copyText.select();
    copyText.setSelectionRange(0, 99999);
    navigator.clipboard.writeText(copyText.value);
    
    var tooltip = document.getElementById("myTooltip");
    tooltip.innerHTML = "Copied: " + copyText.value;
  }
  
  function outFunc() {
    var tooltip = document.getElementById("myTooltip");
    tooltip.innerHTML = "Copy to clipboard";
  }
  </script>
<%- include('../views/include/footer.ejs')%>